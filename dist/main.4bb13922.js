!function(o){var e={};function i(t){if(e[t])return e[t].exports;var n=e[t]={i:t,l:!1,exports:{}};return o[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=o,i.c=e,i.d=function(t,n,o){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(n,t){if(1&t&&(n=i(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var e in n)i.d(o,e,function(t){return n[t]}.bind(null,e));return o},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="/",i(i.s=2)}([function(t,n,o){},function(t,n,o){},function(t,n,o){t.exports=o(3)},function(t,n,o){var e=o(6);t.exports=e;var i=function(n){n.install=function(t){return t.component(n.name,n)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(n)};for(var r in e)i(e[r])},function(t,n,o){"use strict";var e=o(0);o.n(e).a},function(t,n,o){"use strict";var e=o(1);o.n(e).a},function(t,n,o){"use strict";o.r(n);var e={};o.r(e),o.d(e,"updateBoxLayout",function(){return u}),o.d(e,"updateBoxPosition",function(){return l}),o.d(e,"positionsAreColliding",function(){return s}),o.d(e,"isFree",function(){return f}),o.d(e,"bubbleUp",function(){return c}),o.d(e,"moveBoxToFreePlace",function(){return p}),o.d(e,"sortLayout",function(){return g}),o.d(e,"layoutBubbleUp",function(){return y}),o.d(e,"positionToPixels",function(){return d}),o.d(e,"getLayoutSize",function(){return h}),o.d(e,"matchesSelector",function(){return x}),o.d(e,"layoutHasCollisions",function(){return b}),o.d(e,"fixLayout",function(){return m});function i(t){return function(t){if(Array.isArray(t)){for(var n=0,o=new Array(t.length);n<t.length;n++)o[n]=t[n];return o}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},e=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.forEach(function(t){a(n,t,o[t])})}return n}function a(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}var u=function(t,n){return r({},t,n)},l=function(t,n){return u(t,{position:r({},t.position,n)})},s=function(t,n){return t.x<n.x+n.w&&t.x+t.w>n.x&&t.y<n.y+n.h&&t.y+t.h>n.y},f=function(t,n){for(var o=0;o<t.length;o++)if(s(t[o].position,n))return!1;return!0},c=function(t,n){for(;n=l(n,{y:n.position.y-1}),f(t,n.position)&&0<=n.position.y;);return l(n,{y:n.position.y+1})},p=function(t,n,o,e){o&&(n=c(t,n));var i=n.position.x,r=n.position.y,a=0;if(isFinite(e))if(n.position.w>e){var u=n.position.w;console.warn("utils::moveBoxToFreePlace: box is wider than dashboard. setting box width to maxColumnCount",n,u,e),n.position.w=e}else a=e-n.position.w;for(var s=f(t,n.position),d=-1;!s;){for(;!s&&(0<n.position.x||!isFinite(e));)n=l(n,{x:n.position.x-1}),s=f(t,n.position);for(;!s&&(n.position.x<a||!isFinite(e));)n=l(n,{x:n.position.x+1}),s=f(t,n.position);s||(0==n.position.y&&(n.position.y=r,d=1),n=l(n,{x:i,y:n.position.y+d}),s=f(t,n.position))}return n},g=function(t){return i(t).sort(function(t,n){return t.hidden&&!n.hidden?1:!t.hidden&&n.hidden?-1:t.pinned&&!n.pinned?-1:!t.pinned&&n.pinned?1:t.position.y<n.position.y?-1:t.position.y>n.position.y?1:t.position.x<n.position.x?-1:t.position.x>n.position.x?1:0})},y=function(t){t=g(t);var n=[];return t.forEach(function(t){n.push(c(n,t))}),n},d=function(t,n){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return{x:t.x*n.w+t.x*o+e,y:t.y*n.h+t.y*o+e,w:t.w*n.w+(t.w-1)*o,h:t.h*n.h+(t.h-1)*o}},h=function(t){return{w:t.reduce(function(t,n){return n.hidden?t:Math.max(t,n.position.x+n.position.w)},0),h:t.reduce(function(t,n){return n.hidden?t:Math.max(t,n.position.y+n.position.h)},0)}},x=function(t,n){var o=Element.prototype;return(o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||function(t){return-1!==[].indexOf.call(document.querySelectorAll(t),this)}).call(t,n)},b=function(t){for(var n=0;n<t.length;n++)for(var o=n+1;o<t.length;o++)if(s(t[n].position,t[o].position))return!0;return!1},m=function(t,n,o){t=g(t);var e=[];return t.forEach(function(t){e.push(p(e,t,n,o))}),e},v={name:"DndGridBox",props:{boxId:{required:!0},dragSelector:{type:String,default:"*"},x:{type:Number,default:function(){return 0}},y:{type:Number,default:function(){return 0}},h:{type:Number,default:function(){return 1}},w:{type:Number,default:function(){return 1}},pinned:{type:Boolean,default:function(){return!1}},hidden:{type:Boolean,default:function(){return!1}}},data:function(){return{container:null,dragging:!1,resizing:!1}},computed:{style:function(){if(this.container&&this.container.isBoxVisible(this.boxId)){var t=this.container.getPixelPositionById(this.boxId);return{display:"block",width:t.w+"px",height:t.h+"px",transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}}return{display:"none"}},classes:function(){return{"dnd-grid-box":!0,dragging:this.dragging,resizing:this.resizing}}},methods:{findContainer:function(){for(var t=this;t.$parent;)if(t=t.$parent,B.has(t))return t;return null}},mounted:function(){var a=this;if(this.container=this.findContainer(),!this.container)throw new Error("Can not find container");this.container.registerBox(this),this.$dragHandle=this.$el||this.$refs.dragHandle,this.$dragHandle.addEventListener("mousedown",function(t){if(x(t.target,a.dragSelector)){t.preventDefault(),a.dragging=!0,a.$emit("dragStart");var e=t.clientX,i=t.clientY,r=function(t){var n={x:t.clientX-e,y:t.clientY-i};a.$emit("dragUpdate",{offset:n})};window.addEventListener("mouseup",function t(n){window.removeEventListener("mouseup",t,!0),window.removeEventListener("mousemove",r,!0),a.dragging=!1;var o={x:n.clientX-e,y:n.clientY-i};a.$emit("dragEnd",{offset:o})},!0),window.addEventListener("mousemove",r,!0)}}),this.$resizeHandle=this.$refs.resizeHandle,this.$resizeHandle&&this.$resizeHandle.addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),a.resizing=!0,a.$emit("resizeStart");var e=t.clientX,i=t.clientY,r=function(t){var n={x:t.clientX-e,y:t.clientY-i};a.$emit("resizeUpdate",{offset:n})};window.addEventListener("mouseup",function t(n){window.removeEventListener("mouseup",t,!0),window.removeEventListener("mousemove",r,!0),a.resizing=!1;var o={x:n.clientX-e,y:n.clientY-i};a.$emit("resizeEnd",{offset:o})},!0),window.addEventListener("mousemove",r,!0)})},beforeDestroy:function(){this.container&&this.container.unregisterBox(this)}};o(4);function w(t,n,o,e,i,r,a,u){var s,d="function"==typeof t?t.options:t;if(n&&(d.render=n,d.staticRenderFns=o,d._compiled=!0),e&&(d.functional=!0),r&&(d._scopeId="data-v-"+r),a?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},d._ssrRegister=s):i&&(s=u?function(){i.call(this,this.$root.$options.shadowRoot)}:i),s)if(d.functional){d._injectStyles=s;var l=d.render;d.render=function(t,n){return s.call(n),l(t,n)}}else{var f=d.beforeCreate;d.beforeCreate=f?[].concat(f,s):[s]}return{exports:t,options:d}}var L=w(v,function(){var t=this,n=t.$createElement,o=t._self._c||n;return o("div",{ref:"dragHandle",class:t.classes,style:t.style},[t._t("default"),t._v(" "),o("div",{ref:"resizeHandle",staticClass:"resize-handle"})],2)},[],!1,null,null,null).exports;function z(t){return function(t){if(Array.isArray(t)){for(var n=0,o=new Array(t.length);n<t.length;n++)o[n]=t[n];return o}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},e=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.forEach(function(t){$(n,t,o[t])})}return n}function $(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}var B=new Set,S={name:"DndGridContainer",components:{Box:L},props:{layout:{type:Array,required:!0},cellSize:{type:Object,default:function(){return{w:100,h:100}}},maxColumnCount:{type:Number,default:1/0},maxRowCount:{type:Number,default:1/0},margin:{type:Number,default:5},outerMargin:{type:Number,default:0},bubbleUp:{type:Boolean,default:!1},autoAddLayoutForNewBox:{type:Boolean,required:!1,default:!0},defaultSize:{type:Object,required:!1,default:function(){return{w:1,h:1}}},fixLayoutOnLoad:{type:Boolean,required:!1,default:!0}},watch:{layout:function(t){this.fixLayoutOnLoad&&b(t)&&this.updateLayout(m(t,this.bubbleUp,this.maxColumnCount))}},data:function(){return{placeholder:{hidden:!0,position:{x:0,y:0,w:1,h:1}},dragging:{boxLayout:null,offset:{x:0,y:0}},resizing:{boxLayout:null,offset:{x:0,y:0}},isMounted:!1}},computed:{style:function(){var t=h(this.layout),n={minWidth:isFinite(this.maxColumnCount)?this.maxColumnCount*this.cellSize.w+(this.maxColumnCount-1)*this.margin+2*this.outerMargin+"px":0<t.w?t.w*this.cellSize.w+(t.w-1)*this.margin+2*this.outerMargin+"px":"100%",minHeight:isFinite(this.maxRowCount)?this.maxRowCount*this.cellSize.h+(this.maxRowCount-1)*this.margin+2*this.outerMargin+"px":0<t.h?t.h*this.cellSize.h+(t.h-1)*this.margin+2*this.outerMargin+"px":"100%"};return console.log("dnd-grid-container::computed::style",n,t,this.layout),n},pinnedLayout:function(){return this.layout.filter(function(t){return t.pinned})},layoutMap:function(){var n=new Map;return this.layout.forEach(function(t){n.set(t.id,t)}),n}},methods:{getBoxLayoutById:function(t){return"::placeholder::"===t?this.placeholder:this.layoutMap.get(t)},getPixelPositionById:function(t){if(this.dragging.boxLayout&&this.dragging.boxLayout.id===t){var n=d(this.dragging.boxLayout.position,this.cellSize,this.margin,this.outerMargin);return n.x+=this.dragging.offset.x,n.y+=this.dragging.offset.y,n}if(this.resizing.boxLayout&&this.resizing.boxLayout.id===t){var o=d(this.resizing.boxLayout.position,this.cellSize,this.margin,this.outerMargin);return o.w+=this.resizing.offset.x,o.h+=this.resizing.offset.y,o}var e=this.getBoxLayoutById(t);return d(e.position,this.cellSize,this.margin,this.outerMargin)},isBoxVisible:function(t){var n=this.getBoxLayoutById(t);return n&&!n.hidden},getPositionByPixel:function(t,n){return{x:Math.round(t/(this.cellSize.w+this.margin)),y:Math.round(n/(this.cellSize.h+this.margin))}},updateLayout:function(t){this.$emit("update:layout",t)},registerBox:function(t){var n=p(this.layout,{id:t.$props.boxId,hidden:t.$props.hidden,pinned:t.$props.pinned,position:{x:t.$props.pinned?t.$props.x:0,y:t.$props.pinned?t.$props.y:0,w:t.$props.w,h:t.$props.h}},this.bubbleUp,this.maxColumnCount);this.layout.push(n),console.log("Container::registerBox",t.$props.boxId,n.position.w,n.position.h,n.position.x,n.position.y,this.layout),this.enableResizing(t),this.enableDragging(t),this.isMounted&&this.autoAddLayoutForNewBox&&this.createBoxLayout(t.$props.boxId)},unregisterBox:function(t){},enableDragging:function(o){var a,u=this,s=!1,d=function(t,n){return t+u.dragging.boxLayout.position.w>u.maxColumnCount?t=u.maxColumnCount-u.dragging.boxLayout.position.w:t<0&&(t=0),n+u.dragging.boxLayout.position.h>u.maxRowCount?n=u.maxRowCount-u.dragging.boxLayout.position.h:n<0&&(n=0),{targetX:t,targetY:n}};o.$on("dragStart",function(t){var n=u.getBoxLayoutById(o.boxId);n.pinned||(s=!0,u.dragging.boxLayout=n,u.placeholder=C({},u.dragging.boxLayout),a=g(u.layout),u.$emit("drag:start",a))}),o.$on("dragUpdate",function(t){if(s){u.dragging.offset.x=t.offset.x,u.dragging.offset.y=t.offset.y;var n=u.getPositionByPixel(t.offset.x,t.offset.y);if(f(u.pinnedLayout,C({},u.dragging.boxLayout.position,{x:u.dragging.boxLayout.position.x+n.x,y:u.dragging.boxLayout.position.y+n.y}))){var o=d(u.dragging.boxLayout.position.x+n.x,u.dragging.boxLayout.position.y+n.y),e=o.targetX,i=o.targetY;if(u.placeholder.position.x!==e||u.placeholder.position.y!==i){u.placeholder=l(u.placeholder,{x:e,y:i});var r=[u.placeholder];a.forEach(function(t){t.id!==u.dragging.boxLayout.id&&r.push(p(r,t,u.bubbleUp,u.maxColumnCount))}),u.bubbleUp&&(r=y(r),u.placeholder=r.find(function(t){return t.id===u.dragging.boxLayout.id})),u.updateLayout(r),u.$emit("drag:update",r)}}}}),o.$on("dragEnd",function(t){if(s){var n=u.getPositionByPixel(t.offset.x,t.offset.y);if(f(u.pinnedLayout,C({},u.dragging.boxLayout.position,{x:u.dragging.boxLayout.position.x+n.x,y:u.dragging.boxLayout.position.y+n.y}))){var o=d(u.dragging.boxLayout.position.x+n.x,u.dragging.boxLayout.position.y+n.y),e=o.targetX,i=o.targetY;u.placeholder=l(u.placeholder,{x:e,y:i})}u.dragging.boxLayout=l(u.dragging.boxLayout,{x:u.placeholder.position.x,y:u.placeholder.position.y});var r=[u.dragging.boxLayout];a.forEach(function(t){t.id!==u.dragging.boxLayout.id&&r.push(p(r,t,u.bubbleUp,u.maxColumnCount))}),u.bubbleUp&&(r=y(r)),u.updateLayout(r),u.dragging.boxLayout=null,u.dragging.offset.x=0,u.dragging.offset.y=0,u.placeholder.hidden=!0,s=!1,u.$emit("drag:end",r)}})},enableResizing:function(o){var a,u=this,s=!1,d=function(t,n){return u.resizing.boxLayout.position.x+t>u.maxColumnCount?t=u.maxColumnCount-u.resizing.boxLayout.position.x:t<1&&(t=1),u.resizing.boxLayout.position.y+n>u.maxRowCount?n=u.maxRowCount-u.resizing.boxLayout.position.y:n<1&&(n=1),{targetW:t,targetH:n}};o.$on("resizeStart",function(t){var n=u.getBoxLayoutById(o.boxId);n.pinned||(s=!0,u.resizing.boxLayout=n,u.placeholder=C({},u.resizing.boxLayout),a=g(u.layout),u.$emit("resize:start",a))}),o.$on("resizeUpdate",function(t){if(s){u.resizing.offset.x=t.offset.x,u.resizing.offset.y=t.offset.y;var n=u.getPositionByPixel(t.offset.x,t.offset.y);if(f(u.pinnedLayout,C({},u.resizing.boxLayout.position,{w:u.resizing.boxLayout.position.w+n.x,h:u.resizing.boxLayout.position.h+n.y}))){var o=d(u.resizing.boxLayout.position.w+n.x,u.resizing.boxLayout.position.h+n.y),e=o.targetW,i=o.targetH;if(u.placeholder.position.w!==e||u.placeholder.position.h!==i){u.placeholder=l(u.placeholder,{w:e,h:i});var r=[u.placeholder];a.forEach(function(t){t.id!==u.resizing.boxLayout.id&&r.push(p(r,t,u.bubbleUp,u.maxColumnCount))}),u.bubbleUp&&(r=y(r),u.placeholder=r.find(function(t){return t.id===u.resizing.boxLayout.id})),u.updateLayout(r),u.$emit("resize:update",r)}}}}),o.$on("resizeEnd",function(t){if(s){var n=u.getPositionByPixel(t.offset.x,t.offset.y);if(f(u.pinnedLayout,C({},u.resizing.boxLayout.position,{w:u.resizing.boxLayout.position.w+n.x,h:u.resizing.boxLayout.position.h+n.y}))){var o=d(u.resizing.boxLayout.position.w+n.x,u.resizing.boxLayout.position.h+n.y),e=o.targetW,i=o.targetH;u.placeholder=l(u.placeholder,{w:e,h:i})}u.resizing.boxLayout=l(u.resizing.boxLayout,{w:u.placeholder.position.w,h:u.placeholder.position.h});var r=[u.resizing.boxLayout];a.forEach(function(t){t.id!==u.resizing.boxLayout.id&&r.push(p(r,t,u.bubbleUp,u.maxColumnCount))}),u.bubbleUp&&(r=y(r)),u.updateLayout(r),u.resizing.boxLayout=null,u.resizing.offset.x=0,u.resizing.offset.y=0,u.placeholder.hidden=!0,u.$emit("resize:end",r)}})},createBoxLayout:function(){for(var n=this,t=arguments.length,o=new Array(t),e=0;e<t;e++)o[e]=arguments[e];if((o=o.filter(function(t){return!n.getBoxLayoutById(t)})).length){var i=z(this.layout);o.forEach(function(t){i.push(p(i,{id:t,hidden:!1,position:C({x:0,y:0},n.defaultSize)},n.bubbleUp,n.maxColumnCount))}),this.updateLayout(i)}}},created:function(){B.add(this)},mounted:function(){this.isMounted=!0;var t=this.$children.map(function(t){return t.$props.boxId});this.createBoxLayout.apply(this,z(t))},beforeDestroy:function(){B.delete(this)}},E=(o(5),w(S,function(){var t=this,n=t.$createElement,o=t._self._c||n;return o("div",{staticClass:"dnd-grid-container",style:t.style},[t._t("default"),t._v(" "),o("box",{staticClass:"placeholder",attrs:{boxId:"::placeholder::"}})],2)},[],!1,null,null,null).exports);o.d(n,"Container",function(){return E}),o.d(n,"Box",function(){return L}),o.d(n,"utils",function(){return e})}]);
//# sourceMappingURL=main.4bb13922.js.map